## 主流数据库框架

不知道大家是否还记得使用jdbc如何操作数据库？
加载驱动、获取连接、拼接sql、执行sql、获取结果、解析结果、关闭数据库，这些操作是纯jdbc的方式必经的一些过程，每次操作数据库都需要写这些，但是真正和开发相关有：拼接sql、执行sql、解析结果，这几个可能不同，而其他的几个步骤是所有db操作共用的一些步骤，所以纯jdbc的方式重复性的代码太多了，如果每个操作都使用这种方式会耗费大量的时间。
纯jdbc的方式，sql多数都是写在java代码中，我还记得刚开始工作的时候接触的第一个项目就是jdbc写的，当时jdbc是写在jsp中，调试和维护起来是相当麻烦的。
还有就是动态sql方面：面对于各种复杂的条件查询，需要在代码中写很多判断，拼接sql，这种情况估计大家都有经历过，应该是有同感的，各种判断各种拼接没有统一的规范，各种写法也是千奇百怪，最终导致系统难以维护。
上面这些问题使系统开发缓慢、难以维护，后面就出现了各种优秀的框架来解决这些问题，下面我们就来看一下常见的db框架及他们的优缺点，以及我们应该如何选择？

### Hibernate

这个框架学过，但是实际工作中所有接触的项目都未曾使用过hibernate。

介绍hibernate之前，我们先了解一下什么是ORM？

ORM（Object Relational Mapping）：对象关系映射，简单点说就是将数据库中的表和java中的对象建立映射关系，可以让我们操作对象来间接的操作数据库。

ORM最好的框架就是hibernate，hibernate可以让你通过java对象来间接的操作数据库，java对象就相当于数据库中表的代理一样，当你想删除表的数据的时候，不需要自己写delete语句发给数据库，只需要对hibernate说我需要删除哪个java对象就行了，hibernate自动根据你的操作去生成db需要的sql然后发给db去执行，对于开发者来说隐藏了底层jdbc和db的交互过程，可能开发者不需要掌握数据库技术，就可以通过这个框架直接操作数据库，比如对数据库进行增、删、改、查可能需要开发者会写各种sql脚本，还有每种数据库的sql脚本语法也不一样，刚开始项目使用的是mysql，你按照mysql的语法写的，后面可能要切换到oracle，语法上面需要变动，但是如果你使用hibernate，这些都不是问题，你不会sql也没关系，而你只需要像操作对象一样去操作数据库，hibernate会根据你的操作和db的类型自动生成操作所需要的sql，一种写法能够跨多种数据库运行。

#### 优点

1. 简化了整个jdbc操作过程
2. 对于开发者来说不需要关心sql了，只需要去操作对象就可以了，hibernate可以帮我们自动生成所需要的sql
3. 代码移植性比较好，通过hibernate操作db都是通过操作对象来进行的，而hibernate会根据我们的操作和db的类型生成符合各种db要求的sql，如果我们需要切换db的类型，hibernate会自动适应，对于开发者业务代码来说不需要做任何业务代码上的调整
4. 开发效率比较高

#### 缺点

1. sql优化比较艰难，各种操作最终发给db的sql是由hibernate自动生成的，对于开发者来说如果想干预最终需要执行的sql，相对来说比较困难
2. hibernate入门比较容易，但是想成为高手学习成本比较高
3. 对于复杂的动态sql，代码中也需要写很多判断进行组装，动态sql这块的支持比较欠缺

如果做一些简单的系统，开发周期也比较紧急，对sql的优化要求也不是很高，可以使用hibernate。

### JdbcTemplate

jdbctemplate是在spring框架的基础上开发的一个jdbc框架，所以对spring是有依赖的，它对jdbc做了封装，隐藏了各种重复的操作，使用时只需传入：需要执行的sql、参数以及对于结果如何解析的程序就可以了，使用起来还是很方便的，但是面对与动态sql，它也是无能为力了。整体上来说，jdbctemplate相对于纯jdbc隐藏了很多重复性的操作，对于sql的写法和结果的组装上完全交给了开发者自己去控制，在系统中使用也可以帮助我们节约很多时间，而且学习相当简单，花2个小时就学会了，也是很优秀的一个框架。

### Mybatis

mybatis相对于纯jdbc来说，也隐藏了重复性的工作，mybatis是一个半自动化的orm框架，为什么说是半自动化的呢，因为他需要我们自己去写sql，而他做的更好的地方就是动态sql的支持上面，而上面说的各种技术，面对与动态sql只能自己写很多判断去组装sql，而这些判断和组装在mybatis中实现起来就非常简单了，完全由mybatis去帮我们实现了。mybatis将sql交由开发者去控制，所以在sql的优化方面，开发者可以随心所欲，也就是说mybatis将重复性的工作优化到了极致：操作db的过程、动态sql的拼装、结果和对象的映射，这些mybatis都帮我们实现的很好，而让我们将更多的经历花在sql的写法和优化上面，所以毫无疑问mybatis使用人数和公司也是最多的，大部分互联网公司基本上都会使用mybatis，其他2种可以不会，但是mybatis你必须要会。

### 几种技术的对比

|               | 纯JDBC | Hibernate | JdbcTemplate | Mybatis |
| ------------- | ------ | --------- | ------------ | ------- |
| 代码重复度    | 高     | 低        | 低           | 低      |
| 动态sql支持度 | 低     | 低        | 低           | 高      |
| sql控制度     | 高     | 低        | 低           | 高      |
| 学习成本      | 低     | 高        | 低           | 低      |
| 开发速度      | 慢     | 高        | 高           | 高      |
| 使用的公司    | 少     | 比较多    | 比较多       | 最多    |

常见数据库安装方式

### Mysql

[MySQL 5.7史上最详细下载安装配置教程，肝了！ - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/373515920)

## 常见数据库连接 URL

### mysql

```yaml
jdbc.driver=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://${host}:${port}/${dbname}?useSSL=false&characterEncoding=utf8
# 表示不使用SSL加密
# characterEncoding:使用UTF-8作为字符编码
```

### postgres

```properties
jdbc.driver=org.postgresql.Driver 
jdbc.url=jdbc:postgresql://localhost:5432/test
```

### oracle

### SqlServer